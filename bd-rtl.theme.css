/**
 * @name BDRTL
 * @description attempts to make chats RTL
 * @version 1.0.0
 * @author ImXanax
 * @authorId 413755451373518864
 * @website https://github.com/ImXanax/bd-rtl
 * @source https://github.com/ImXanax/bd-rtl/blob/main/bd-rtl.theme.css
 * @updateUrl https://raw.githubusercontent.com/ImXanax/bd-rtl/refs/heads/main/bd-rtl.theme.css
 */

/*border gap for other messages */
li[id^="chat-messages-"]:not(li[class*="myMessage"]) {
    margin-left: 70px !important;
}
/* message headers , name and icon */
li[id^="chat-messages-"] > div[class^="message"]  >div[class*="contents"] > h3[class^="header"] {
    display: flex;
    flex-direction: row-reverse;
    text-align: right;
    gap: 0.5rem;
}

/* set background for all msgs */
li[id^="chat-messages-"] > div[class*="cozyMessage"] {
    border: 2px solid var(--bg-overlay-1,var(--background-message-hover)) !important;
    border-radius: 10px !important;
    padding: 5px !important;
    margin-bottom: 10px !important;
    max-width: 320px !important;
}

/* set inline padding in msgs */
li[id^="chat-messages-"] > div[class*="cozyMessage"] > div[class^="contents"] {
    padding: 6px !important;
}


/* fix avatar of others outside their msgs */
li[id^="chat-messages-"] > div[class*="cozyMessage"] > div[class^="contents"] > img:first-child:not(.myAvatar) {
    margin-bottom: 25px !important;
    left: -50px !important;
    right: unset !important;
}

li[id^="chat-messages-"] > div[class*="cozyMessage"] > div[class^="contents"] > img + img:not(.myAvatarDecoration) {
    margin-bottom: 25px !important;
    left: -54px !important;
    right: unset !important;
}
/* spine for messages with threads */
li[id^="chat-messages-"] > div[class*="cozyMessage"][class*="hasThread"]:not(.myWrapper)::after{
    left: calc(var(--custom-message-margin-horizontal) + var(--chat-avatar-size) / 2 - 66px) !important;
}
/* spine for my messages with threads */
div.myWrapper[class*="hasThread"]::after{
    left: auto !important; /* cancel left so it doesnâ€™t conflict */

    /* move to right instead of left */
    right: calc(var(--custom-message-margin-horizontal) + var(--chat-avatar-size) / 2 - 66px);
    /* size of spine */
    border-left: unset;
    border-bottom: 2px solid var(--spine-default);
    border-bottom-right-radius: 8px;
    border-bottom-left-radius: unset !important;
    border-right: 2px solid var(--spine-default);
}

/* fix reply pseudo */
div[class^="repliedMessage"]:not(.myWrapper):before {
    right: 103%;
}
.myWrapper > div[id^="message-reply"]:before {
    left: 105% !important;
    right: calc(-1*(.6*var(--avatar-size) + var(--gutter))) !important;
    transform: rotateY(180deg) !important;
}

/* clickable spine replies */
div.myWrapper[class*="hasReply"] > div[id^="message-reply-context-"] > div[class^="repliedMessageClickableSpine"] {
    border-top-right-radius: 6px !important; /* flipped from left to right */
    border-top-left-radius: 0 !important; /* flipped from left to right */
    border-width: var(--spine-width) var(--spine-width) 0 0 !important; /* mirrored */
    right: calc((var(--chat-avatar-size) / 2 + var(--gutter)) * -1) !important; /* flipped from left */
    margin: calc(var(--spine-width) * -1 / 2) var(--reply-spacing) calc(var(--custom-message-spacing-vertical-container-cozy) - 4px) calc(var(--spine-width) * 10 / 2) !important;
    left: 100% !important; /* swapped sides */
}

/* center accessories embeds */
div[id^="message-accessories"], div[id^="message-accessories"] > article, div[class^="visualMediaItemContainer"] {
    display: grid;
    justify-items: center !important;
    align-self: center !important;
}
div[id^="message-accessories"] > article + div {
    gap: unset;
    justify-content: space-between;
    margin-top: 1rem;
}
div[id^="message-accessories"] > div[class^="wrapper"] {
    margin: 0.5rem 0 !important;
}

div[class^="nonVisualMediaItemContainer"] {
    align-items: center;
}
div[class^="nonVisualMediaItem"] {
    padding: 0.2rem 0 !important;
    max-width: 100% !important;
}

/*removes reaction icon button */
/*div[aria-label="Add Reaction"] {*/
/*    display: none !important;*/
/*}*/
div[class^="reactions"] {
    display: flex !important;
    flex-direction: row-reverse !important;
    justify-content: right !important;
    justify-self: center !important;
    align-self: center !important;
    border-top: 3px solid var(--background-accent) !important;
    border-top-left-radius: 10px !important;
    border-top-right-radius: 10px !important;
    padding-top: 2% !important;
}
div[class^="visualMediaItemContainer"] + div[class^="reactions"] {
    margin-top: 2rem;
}

/* mentioned echo pseudo */
div[class*="mentioned"], div[class*="ephemeral"]:before {
    border: 4px solid var(--accent-3);
    border-top-color: transparent !important;
    border-bottom-color: transparent !important;
    border-right-color: transparent !important;
}
div[class*="mentioned"]:before {
    display: none !important;
}
div[class*="replying"]:before {
    height: 50%;
    top:25%;
}

/* fix timestamp */
span[class*="timestampInline"] {
    vertical-align: top !important;
}
span[class*="timestampVisibleOnHover"] {
    display: none;
}

/* fix texts direction in embeds */
div[class^="gridContainer"] > div:first-child > div[class*="embed"], div[class^="gridContainer"] > div:first-child > div[class*="embed"] > span, div[class^="gridContainer"] > div:first-child > div[class*="embed"] > a {
    text-align: start;
}
div[class^="gridContainer"] {
}

/* centralized special msgs */
div[class^="welcomeCTA"], span[class^="clickableSticker"] {
    display: flex;
    justify-content: center;
    justify-self :center;
}